{% extends "base.html" %}
{% block title %} Flight Detail Page {% endblock %}

{% block csslink %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/assets/css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/assets/css/all-fontawesome.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/assets/css/flaticon.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/assets/css/animate.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/assets/css/magnific-popup.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/assets/css/owl.carousel.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/assets/css/nice-select.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/assets/css/jquery-ui.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/assets/css/jquery.timepicker.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/assets/css/style.css') }}">
{% endblock %}

{% block body %}
    <main class="main">
        {#    顶部title area    #}
        <div class="site-breadcrumb" style="padding-top:100px;background: url({{ url_for('static', filename='css/assets/img/breadcrumb/01.jpg') }})">
            <div class="container">
                <h2 class="breadcrumb-title">{{ _("Flight") }}</h2>
                <ul class="breadcrumb-menu">

                </ul>
            </div>
        </div>

        <div class="hotel-single py-120">
            <div class="container">
                <div class="listing-wrapper">
                    <div class="row">

                        <!-- 左边信息栏 -->
                        <div class="col-lg-8">
                            <div class="listing-content">
                                <div class="listing-slider owl-carousel owl-theme">
                                    {% for image in images %}
                                    <img src="{{ url_for('static', filename=image.replace('\\','/')) }}" alt="" >
                                    {% endfor %}
                                </div>
                                <div class="listing-header">
                                    <div class="listing-header-info">
                                        <!-- title & location -->
                                        <h4 class="listing-title">{{ flight.departure }} - {{ flight.destination }}</h4>
                                        <p class="listing-stop">{{ flight.flight_type }} <span class="badge">{{ flight.flight_stop }}</span></p>
                                    </div>
                                    <div class="listing-rate">
                                        <!-- overall review -->
                                        <span class="badge"><i class="fal fa-star"></i> 5.0</span>
                                        <span class="listing-rate-type">{{ _("Excellent") }}</span>
                                        <span class="listing-rate-review">({{ review_num }} {{ _("reviews") }})</span>
                                    </div>
                                </div>
                                <!-- flight attr -->
                                <div class="listing-item pt-5">
                                    <div class="row">
                                        <div class="col-md-6 col-lg-3">
                                            <div class="listing-feature">
                                                <div class="listing-feature-icon">
                                                    <i class="far fa-plane-up"></i>
                                                </div>
                                                <div class="listing-feature-content">
                                                    <h6>{{ _("Company") }}</h6>
                                                    <span>{{ flight.company }}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-lg-3">
                                            <div class="listing-feature">
                                                <div class="listing-feature-icon">
                                                    <i class="far fa-user-tie"></i>
                                                </div>
                                                <div class="listing-feature-content">
                                                    <h6>{{ _("Flight Type") }}</h6>
                                                    <span>{{ flight.flight_class }}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-lg-3">
                                            <div class="listing-feature">
                                                <div class="listing-feature-icon">
                                                    <i class="far fa-refresh"></i>
                                                </div>
                                                <div class="listing-feature-content">
                                                    <h6>{{ _("Fare Type") }}</h6>
                                                    <span>{{ flight.fare_type }}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-lg-3">
                                            <div class="listing-feature">
                                                <div class="listing-feature-icon">
                                                    <i class="far fa-xmark"></i>
                                                </div>
                                                <div class="listing-feature-content">
                                                    <h6>{{ _("Cancellation Fee") }}</h6>
                                                    <span>{{ flight.cancellation_charge }}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-lg-3">
                                            <div class="listing-feature">
                                                <div class="listing-feature-icon">
                                                    <i class="far fa-dollar-sign"></i>
                                                </div>
                                                <div class="listing-feature-content">
                                                    <h6>{{ _("Flight Change") }}</h6>
                                                    <span>{{ flight.flight_charge }}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-lg-3">
                                            <div class="listing-feature">
                                                <div class="listing-feature-icon">
                                                    <i class="far fa-suitcase"></i>
                                                </div>
                                                <div class="listing-feature-content">
                                                    <h6>{{ _("Seats & Baggage") }}</h6>
                                                    <span>{{ flight.seat_baggage }}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-lg-3">
                                            <div class="listing-feature">
                                                <div class="listing-feature-icon">
                                                    <i class="far fa-cog"></i>
                                                </div>
                                                <div class="listing-feature-content">
                                                    <h6>{{ _("Inflight Features") }}</h6>
                                                    <span>{{ _("Available") }}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-lg-3">
                                            <div class="listing-feature">
                                                <div class="listing-feature-icon">
                                                    <i class="far fa-percent"></i>
                                                </div>
                                                <div class="listing-feature-content">
                                                    <h6>{{ _("Taxes & Fees") }}</h6>
                                                    <span>{{ flight.taxes }}</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="listing-item">
                                    <h4 class="mb-3">{{ _("About") }} {{ flight.company }}</h4>
                                    <p class="mt-3">{{ flight.description }}</p>
                                </div>

                                <div class="listing-item">
                                    <h4 class="mb-3">{{ _("Inflight Features") }}</h4>
                                    <div class="listing-amenity">
                                        <div class="row">
                                            {% if wifi %}
                                            <div class="col-lg-4">
                                                <div class="listing-amenity-item">
                                                    <h6><i class="far fa-wifi"></i> {{ _("Wifi") }}</h6>
                                                </div>
                                            </div>
                                            {% endif %}
                                        {% if television %}
                                            <div class="col-lg-4">
                                                <div class="listing-amenity-item">
                                                    <h6><i class="far fa-tv"></i> {{ _("Television") }}</h6>
                                                </div>
                                            </div>
                                        {% endif %}
                                        {% if entertainment %}
                                            <div class="col-lg-4">
                                                <div class="listing-amenity-item">
                                                    <h6><i class="far fa-music"></i> {{ _("Entertainment") }}</h6>
                                                </div>
                                            </div>
                                        {% endif %}
                                        {% if coffee %}
                                            <div class="col-lg-4">
                                                <div class="listing-amenity-item">
                                                    <h6><i class="far fa-cup-togo"></i> {{ _("Coffee") }}</h6>
                                                </div>
                                            </div>
                                        {% endif %}
                                        {% if air_condition %}
                                            <div class="col-lg-4">
                                                <div class="listing-amenity-item">
                                                    <h6><i class="far fa-air-conditioner"></i> {{ _("Air Conditioning") }}</h6>
                                                </div>
                                            </div>
                                        {% endif %}
                                        {% if food %}
                                            <div class="col-lg-4">
                                                <div class="listing-amenity-item">
                                                    <h6><i class="fa-regular fa-salad"></i> {{ _("Food") }}</h6>
                                                </div>
                                            </div>
                                        {% endif %}
                                        {% if game %}
                                            <div class="col-lg-4">
                                                <div class="listing-amenity-item">
                                                    <h6><i class="far fa-gamepad-modern"></i> {{ _("Games") }}</h6>
                                                </div>
                                            </div>
                                        {% endif %}
                                        {% if wines %}
                                            <div class="col-lg-4">
                                                <div class="listing-amenity-item">
                                                    <h6><i class="far fa-wine-bottle"></i> {{ _("Wines") }}</h6>
                                                </div>
                                            </div>
                                        {% endif %}
                                        {% if comfort %}
                                            <div class="col-lg-4">
                                                <div class="listing-amenity-item">
                                                    <h6><i class="far fa-couch"></i> {{ _("Comfort") }}</h6>
                                                </div>
                                            </div>
                                        {% endif %}
                                        {% if magazines %}
                                            <div class="col-lg-4">
                                                <div class="listing-amenity-item">
                                                    <h6><i class="far fa-image"></i> {{ _("Magazines") }}</h6>
                                                </div>
                                            </div>
                                        {% endif %}
                                        </div>
                                    </div>
                                </div>

                                <div class="listing-item">
                                    <h4 class="mb-3">{{ _("Fare Rules For Your Flight") }}</h4>
                                    <div class="listing-amenity">
                                        <div class="row">
                                            <div class="col-lg-4">
                                                <div class="listing-amenity-item">
                                                    <h6><i class="far fa-check"></i> {{ _("Rules And Policies") }}</h6>
                                                </div>
                                            </div>
                                            <div class="col-lg-4">
                                                <div class="listing-amenity-item">
                                                    <h6><i class="far fa-check"></i> {{ _("Flight Changes") }}</h6>
                                                </div>
                                            </div>
                                            <div class="col-lg-4">
                                                <div class="listing-amenity-item">
                                                    <h6><i class="far fa-check"></i> {{ _("Refunds") }}</h6>
                                                </div>
                                            </div>
                                            <div class="col-lg-4">
                                                <div class="listing-amenity-item">
                                                    <h6><i class="far fa-check"></i> {{ _("Airline Penalties") }}</h6>
                                                </div>
                                            </div>
                                            <div class="col-lg-4">
                                                <div class="listing-amenity-item">
                                                    <h6><i class="far fa-check"></i> {{ _("Flight Cancellation") }}</h6>
                                                </div>
                                            </div>
                                            <div class="col-lg-4">
                                                <div class="listing-amenity-item">
                                                    <h6><i class="far fa-check"></i> {{ _("Airline Terms Of Use") }}</h6>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- review area -->
                                <div class="listing-item">
                                    <h4 class="mb-3">{{ _("Reviews") }}</h4>
                                    <div class="listing-rating-box">
                                        <div class="listing-review-rating">
                                            <div class="listing-rating-count">
                                                <h2>{{ star_score }}</h2>
                                                <div class="listing-rating-star">
                                                    {% for i in range(star_score_ceil) %}
                                                    <i class="fas fa-star"></i>
                                                    {% endfor %}
                                                </div>
                                               <p>{{ _("Based On") }} {{ review_num }} {{ _("Reviews") }}</p>
                                            </div>
                                            <div class="listing-rating-range">
                                                <div class="listing-rating-range-item">
                                                    <div class="listing-rating-range-star">
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star"></i>
                                                    </div>
                                                    <div class="listing-rating-range-bar">
                                                        <div class="listing-progress">
                                                            <div class="listing-progress-width" style="width: {{ 100*star_detail[4]/(5*flight.review_num) }}%">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="listing-rating-range-percentage">
                                                        <span>{{ (100*star_detail[4]/(5*flight.review_num))|int }}%</span>
                                                    </div>
                                                </div>
                                                <div class="listing-rating-range-item">
                                                    <div class="listing-rating-range-star">
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star"></i>
                                                        <i class="far fa-star"></i>
                                                    </div>
                                                    <div class="listing-rating-range-bar">
                                                        <div class="listing-progress">
                                                            <div class="listing-progress-width" style="width: {{ 100*star_detail[3]/(4*flight.review_num) }}%">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="listing-rating-range-percentage">
                                                        <span>{{ (100*star_detail[3]/(4*flight.review_num))|int }}%</span>
                                                    </div>
                                                </div>
                                                <div class="listing-rating-range-item">
                                                    <div class="listing-rating-range-star">
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star"></i>
                                                        <i class="far fa-star"></i>
                                                        <i class="far fa-star"></i>
                                                    </div>
                                                    <div class="listing-rating-range-bar">
                                                        <div class="listing-progress">
                                                            <div class="listing-progress-width" style="width: {{ (100*star_detail[2]/(3*flight.review_num))|int }}%">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="listing-rating-range-percentage">
                                                        <span>{{ (100*star_detail[2]/(3*flight.review_num))|int }}%</span>
                                                    </div>
                                                </div>
                                                <div class="listing-rating-range-item">
                                                    <div class="listing-rating-range-star">
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star"></i>
                                                        <i class="far fa-star"></i>
                                                        <i class="far fa-star"></i>
                                                        <i class="far fa-star"></i>
                                                    </div>
                                                    <div class="listing-rating-range-bar">
                                                        <div class="listing-progress">
                                                            <div class="listing-progress-width" style="width: {{ (100*star_detail[1]/(2*flight.review_num))|int }}%">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="listing-rating-range-percentage">
                                                        <span>{{ (100*star_detail[1]/(2*flight.review_num))|int }}%</span>
                                                    </div>
                                                </div>
                                                <div class="listing-rating-range-item">
                                                    <div class="listing-rating-range-star">
                                                        <i class="fas fa-star"></i>
                                                        <i class="far fa-star"></i>
                                                        <i class="far fa-star"></i>
                                                        <i class="far fa-star"></i>
                                                        <i class="far fa-star"></i>
                                                    </div>
                                                    <div class="listing-rating-range-bar">
                                                        <div class="listing-progress">
                                                            <div class="listing-progress-width" style="width: {{ (100*star_detail[0]/(1*flight.review_num))|int }}%">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="listing-rating-range-percentage">
                                                        <span>{{ (100*star_detail[0]/(1*flight.review_num))|int }}%</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="listing-review">
                                            <h5>{{ _("Showing") }} {{ review_num }} {{ _("Reviews") }}</h5>
                                            {% for review in reviews %}
                                            <div class="listing-review-item">
                                                <div class="listing-review-author">

                                                    <img src="https://avatar.oxro.io/avatar.svg?name={{ review.customerID }}" alt="">
                                                    <!-- <img src="{{ url_for('static', filename='css/assets/img/account/01.jpg') }}" alt=""> -->
                                                    <div class="listing-review-author-info">
                                                        <div>
                                                            <h6>{{ review.customerID }}</h6>
                                                            <span><i class="far fa-clock"></i>{{ review.issueTime }}</span>
                                                        </div>
                                                        <div class="listing-review-author-rating">
                                                            {% for i in range(review.rating) %}
                                                                <i class="fas fa-star"></i>
                                                            {% endfor %}
                                                        </div>
                                                    </div>
                                                </div>
                                                <p>
                                                    {{ review.content }}
                                                </p>
                                            </div>
                                            {% endfor %}
                                        </div>

                                        {% if purchased %}
                                        <div class="listing-review-form">
                                            <h4>{{ _("Leave a Review") }}</h4>
                                            <form action="{{ url_for('flight.add_review')}}" method="post">
                                                <div class="col-lg-12">
                                                    <div class="form-group mb-3">
                                                        <input name="productId" value="{{ flight.id }}" hidden>
                                                        <label class="star-label">{{ _("Your Rating") }}</label>
                                                        <div class="listing-review-form-star">
                                                            <div class="star-rating-wrapper">
                                                                <div class="star-rating-box">
                                                                    <input type="radio" name="rating" value="5"
                                                                           id="star-5">
                                                                    <label for="star-5">&#9733;</label>
                                                                    <input type="radio" name="rating" value="4"
                                                                           id="star-4">
                                                                    <label for="star-4">&#9733;</label>
                                                                    <input type="radio" name="rating" value="3"
                                                                           id="star-3">
                                                                    <label for="star-3">&#9733;</label>
                                                                    <input type="radio" name="rating" value="2"
                                                                           id="star-2">
                                                                    <label for="star-2">&#9733;</label>
                                                                    <input type="radio" name="rating" value="1"
                                                                           id="star-1">
                                                                    <label for="star-1">&#9733;</label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                <textarea class="form-control" cols="30" rows="5" name="content"
                                                          placeholder="Write Your Review*"></textarea>
                                                </div>
                                                <button class="theme-btn" type="submit">{{ _("Leave A Review") }}</button>
                                            </form>
                                        </div>
                                        {% endif %}

                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 右边订阅栏 -->
                        <div class="col-lg-4">
                            <div class="booking-sidebar listing-side-content">
                                <div class="booking-item">
                                    <div class="search-form">
                                        <form action="{{ url_for('flight.order_confirm') }}" method="post">
                                        <input name="flight_id" value="{{ flight.id }}" hidden>
                                            <div class="tour-search-wrapper">
                                                <div class="row">
                                                    <div class="col-lg-12">
                                                        <div class="form-group">
                                                            <div class="search-form-date">
                                                                <div class="search-form-journey">
                                                                    <label>{{ _("Journey Date") }}</label>
                                                                    <div class="form-group-icon">
                                                                        <input id="flight-choose" type="text" name="journey-date"
                                                                               class="form-control date-picker journey-date flight-special-date">
                                                                        <i class="fal fa-calendar-days"></i>
                                                                    </div>
                                                                    <p class="journey-day-name"></p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="listing-side-btn">
                                                    <button id="button_bookNow" type="submit" class="theme-btn"><span
                                                            class="far fa-shopping-bag" ></span>{{ _("Book Now") }}
                                                    </button>
                                                   {% if logged %}
                                                    {% if added %}
                                                        <a href="{{ url_for('flight.remove_wishlist', flight_id=flight.id) }}" class="border-btn"  style="background-color:red"><i class="far fa-heart"></i> {{ _("Remove From Wishlist") }}</a>
                                                    {% else %}
                                                        <a href="{{ url_for('flight.add_wishlist', flight_id=flight.id) }}" class="border-btn"><i class="far fa-heart"></i> {{ _("Add To Wishlist") }}</a>
                                                    {% endif %}
                                                {% else %}
                                                    <a href="{{ url_for('customer.re_jump') }}" class="border-btn"><i class="far fa-heart"></i> {{ _("Add To Wishlist") }}</a>
                                                {% endif %}
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="listing-side-share">
                                        <span><i class="far fa-eye"></i> 250 {{ _("Views") }}</span>
                                    </div>
                                </div>
                            </div>
                            <div class="booking-sidebar listing-side-content mt-4">
                                <h4 class="booking-title">{{ _("Get A Question?") }}</h4>
                                <ul class="listing-side-list">
                                    <li><i class="far fa-phone"></i><a href="#">{{ flight.contact_phone }}</a></li>
                                    <li><i class="far fa-envelope"></i><a
                                            href="#"><span
                                            class="__cf_email__" data-cfemail="1970777f76597c61787469757c377a7674">{{ flight.contact_email }}</span></a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    <input id="allowedDates" value="{{ day_of_week }}" hidden>

    </main>
{% endblock %}

{% block jsLink %}
    <script src="{{ url_for('static', filename='css/assets/js/jquery-3.6.0.min.js') }}"></script>
    <script src="{{ url_for('static', filename='css/assets/js/modernizr.min.js') }}"></script>
    <script src="{{ url_for('static', filename='css/assets/js/bootstrap.bundle.min.js') }}"></script>
    <script src="{{ url_for('static', filename='css/assets/js/imagesloaded.pkgd.min.js') }}"></script>
    <script src="{{ url_for('static', filename='css/assets/js/jquery.magnific-popup.min.js') }}"></script>
    <script src="{{ url_for('static', filename='css/assets/js/isotope.pkgd.min.js') }}"></script>
    <script src="{{ url_for('static', filename='css/assets/js/jquery.appear.min.js') }}"></script>
    <script src="{{ url_for('static', filename='css/assets/js/jquery.easing.min.js') }}"></script>
    <script src="{{ url_for('static', filename='css/assets/js/owl.carousel.min.js') }}"></script>
    <script src="{{ url_for('static', filename='css/assets/js/counter-up.js') }}"></script>
    <script src="{{ url_for('static', filename='css/assets/js/masonry.pkgd.min.js') }}"></script>
    <script src="{{ url_for('static', filename='css/assets/js/jquery.nice-select.min.js') }}"></script>
    <script src="{{ url_for('static', filename='css/assets/js/jquery-ui.min.js') }}"></script>
    <script src="{{ url_for('static', filename='css/assets/js/jquery.timepicker.min.js') }}"></script>
    <script src="{{ url_for('static', filename='css/assets/js/wow.min.js') }}"></script>
    <script src="{{ url_for('static', filename='css/assets/js/main.js') }}"></script>
    <script src="{{ url_for('static', filename='js/flight_date.js') }}"></script>
{% endblock %}