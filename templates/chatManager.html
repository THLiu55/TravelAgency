<!DOCTYPE html>
<html class="no-js" lang="en" data-theme="light">

{% extends "BaseManager.html" %}
{% block title %} Manager Chat {% endblock %}

{# head数据均放在该block里 #}
{% block csslink %}
{% endblock %}

{% block body %}
<div class="sidebar-backdrop"></div>
<div class="page-wrapper">
    <main class="page-content page-content--full">
        <div class="chat-grid">
            <div class="chat-users">
                <div class="chat-users__top">
                    <form class="chat-users__search" method="GET">
                        <div class="input-group input-group--prepend">
                            <div class="input-group__prepend">
                                <svg class="icon-icon-search">
                                    <use xlink:href="#icon-search"></use>
                                </svg>
                            </div>
                            <input class="input" type="text" placeholder="Search...">
                        </div>
                    </form>
                    <div class="chat-users__top-right">
                        <button class="chat-users__button-add-users button-icon button-icon--small"
                            data-toggle="users-add-list"><span class="button-icon__icon">
                                <svg class="icon-icon-plus">
                                    <use xlink:href="#icon-plus"></use>
                                </svg></span><span class="button-icon__icon">
                                <svg class="icon-icon-chevron">
                                    <use xlink:href="#icon-chevron"></use>
                                </svg></span>
                        </button>
                    </div>
                </div>
                <div class="chat-users__add-content scrollbar-thin scrollbar-hidden" data-simplebar>
                    <ul class="chat-users__list" id="all-customer-list">
                        <!-- <li class="chat-users__list-header">B</li> -->
                        <li class="chat-users__list-item">
                            <a class="chat-users__item" href="#">
                                <div class="chat-users__item-avatar color-teal">
                                    <div class="chat-users__item-avatar-text">BH</div>
                                    <img src="{{ url_for( 'static', filename='img/content/humans/item-8.jpg' ) }}"
                                        alt="#">
                                </div>
                                <div class="chat-users__item-right">
                                    <h5 class="chat-users__item-name">Billy Hicks</h5>
                                    <div class="text-sm text-grey">Hi there! I'm using chat</div>
                                </div>
                            </a>
                        </li>
                        <li class="chat-users__list-header">C</li>
                        <li class="chat-users__list-item">
                            <a class="chat-users__item" href="#">
                                <div class="chat-users__item-avatar color-green">
                                    <div class="chat-users__item-avatar-text">CL</div>
                                    <img src="{{ url_for( 'static', filename='img/content/humans/item-10.jpg' ) }}"
                                        alt="#">
                                </div>
                                <div class="chat-users__item-right">
                                    <h5 class="chat-users__item-name">Christine Lewis</h5>
                                    <div class="text-sm text-grey">Hi there! I'm using chat</div>
                                </div>
                            </a>
                        </li>
                        <li class="chat-users__list-header">D</li>
                        <li class="chat-users__list-item">
                            <a class="chat-users__item" href="#">
                                <div class="chat-users__item-avatar color-teal">
                                    <div class="chat-users__item-avatar-text">DP</div>
                                    <img src="{{ url_for( 'static', filename='img/content/humans/item-5.jpg' ) }}"
                                        alt="#">
                                </div>
                                <div class="chat-users__item-right">
                                    <h5 class="chat-users__item-name">David Palmer</h5>
                                    <div class="text-sm text-grey">Hi there! I'm using chat</div>
                                </div>
                            </a>
                        </li>
                        <li class="chat-users__list-header">E</li>
                        <li class="chat-users__list-item">
                            <a class="chat-users__item" href="#">
                                <div class="chat-users__item-avatar color-orange">
                                    <div class="chat-users__item-avatar-text">ED</div>
                                    <img src="{{ url_for( 'static', filename='img/content/humans/item-2.jpg' ) }}"
                                        alt="#">
                                </div>
                                <div class="chat-users__item-right">
                                    <h5 class="chat-users__item-name">Elaine Day</h5>
                                    <div class="text-sm text-grey">Hi there! I'm using chat</div>
                                </div>
                            </a>
                        </li>
                        <li class="chat-users__list-header">F</li>
                        <li class="chat-users__list-item">
                            <a class="chat-users__item" href="#">
                                <div class="chat-users__item-avatar color-orange-dark">
                                    <div class="chat-users__item-avatar-text">FB</div>
                                    <img src="{{ url_for( 'static', filename='img/content/humans/item-1.jpg' ) }}"
                                        alt="#">
                                </div>
                                <div class="chat-users__item-right">
                                    <h5 class="chat-users__item-name">Felecia Burke</h5>
                                    <div class="text-sm text-grey">Hi there! I'm using chat</div>
                                </div>
                            </a>
                        </li>
                        <li class="chat-users__list-header">J</li>
                        <li class="chat-users__list-item">
                            <a class="chat-users__item" href="#">
                                <div class="chat-users__item-avatar color-red">
                                    <div class="chat-users__item-avatar-text">JB</div>
                                    <img src="{{ url_for( 'static', filename='img/content/humans/item-4.jpg' ) }}"
                                        alt="#">
                                </div>
                                <div class="chat-users__item-right">
                                    <h5 class="chat-users__item-name">Joan Bates</h5>
                                    <div class="text-sm text-grey">Hi there! I'm using chat</div>
                                </div>
                            </a>
                        </li>
                        <li class="chat-users__list-header">M</li>
                        <li class="chat-users__list-item">
                            <a class="chat-users__item" href="#">
                                <div class="chat-users__item-avatar color-green">
                                    <div class="chat-users__item-avatar-text">MS</div>
                                    <img src="{{ url_for( 'static', filename='img/content/humans/item-6.jpg' ) }}"
                                        alt="#">
                                </div>
                                <div class="chat-users__item-right">
                                    <h5 class="chat-users__item-name">Morris Stevens</h5>
                                    <div class="text-sm text-grey">Hi there! I'm using chat</div>
                                </div>
                            </a>
                        </li>
                        <li class="chat-users__list-header">N</li>
                        <li class="chat-users__list-item">
                            <a class="chat-users__item" href="#">
                                <div class="chat-users__item-avatar color-red">
                                    <div class="chat-users__item-avatar-text">NS</div>
                                    <img src="{{ url_for( 'static', filename='img/content/humans/item-3.jpg' ) }}"
                                        alt="#">
                                </div>
                                <div class="chat-users__item-right">
                                    <h5 class="chat-users__item-name">Nora Stanley</h5>
                                    <div class="text-sm text-grey">Hi there! I'm using chat</div>
                                </div>
                            </a>
                        </li>
                        <li class="chat-users__list-header">T</li>
                        <li class="chat-users__list-item">
                            <a class="chat-users__item" href="#">
                                <div class="chat-users__item-avatar color-orange-dark">
                                    <div class="chat-users__item-avatar-text">TR</div>
                                    <img src="{{ url_for( 'static', filename='img/content/humans/item-7.jpg' ) }}"
                                        alt="#">
                                </div>
                                <div class="chat-users__item-right">
                                    <h5 class="chat-users__item-name">Troy Russell</h5>
                                    <div class="text-sm text-grey">Hi there! I'm using chat</div>
                                </div>
                            </a>
                        </li>
                        <li class="chat-users__list-header">W</li>
                        <li class="chat-users__list-item">
                            <a class="chat-users__item" href="#">
                                <div class="chat-users__item-avatar color-orange">
                                    <div class="chat-users__item-avatar-text">WM</div>
                                    <img src="{{ url_for( 'static', filename='img/content/humans/item-9.jpg' ) }}"
                                        alt="#">
                                </div>
                                <div class="chat-users__item-right">
                                    <h5 class="chat-users__item-name">Walter Miles</h5>
                                    <div class="text-sm text-grey">Hi there! I'm using chat</div>
                                </div>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="chat-users__content scrollbar-thin scrollbar-hidden" data-simplebar>
                    <ul class="chat-users__list" id="unread-customers-list">

                        {% for customer in customers %}
                        <li class="chat-users__list-item">
                            <a class="chat-users__item customer-activatee-a" id="activatee-{{ customer.nickname }}"
                                href="#">
                                <div class="chat-users__item-avatar color-red">
                                    <div class="chat-users__item-avatar-text">{{ (customer.nickname)[0] }}</div>
                                    <span class="badge-signal badge-signal--green"></span>
                                    <img class="customer-avatar"
                                        src="https://avatar.oxro.io/avatar.svg?name={{ customer.nickname }}" alt="#">
                                </div>
                                <div class="chat-users__item-right">
                                    <h5 class="chat-users__item-name customer-nickname-h5"
                                        id="customer-nickname-{{ loop.index }}">{{ customer.nickname }}</h5>
                                    <h5 class="chat-users__item-name customer-id-h5" id="customer-id-{{ loop.index }}"
                                        style="display: none;">{{ customer.id }}</h5>
                                    <div class="chat-users__item-right-group"><span class="chat-users__item-time">1
                                            min</span>
                                    </div>
                                    <div class="chat-users__item-message">
                                        <div class="chat-users__item-badge"><span
                                                class="badge badge--small badge--red unread-counter"
                                                id="unread-counter-{{ customer.nickname }}"
                                                style="{% if customer.amount_unread_msgs == 0 %} display: none; {% endif %}">{{
                                                customer.amount_unread_msgs
                                                }}</span>
                                        </div>
                                        <p class="chat-users__item-text last-msg-preview"
                                            id="last-msg-preview-{{ customer.nickname }}">{% if
                                            ((customer.messages)[-1]).isPic %} (Pic)
                                            {% else %} {{ ((customer.messages)[-1]).content }}{% endif %}</p>
                                    </div>
                                </div>
                            </a>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>

            <div class="chat-details">
                <div class="chat-details__backdrop"></div>
                <div class="chat-details__top">
                    <div class="chat-details__top-left">
                        <button class="chat-details__toggle toggle-sidebar toggle-sidebar--secondary" type="button">
                            <svg class="icon-icon-chevron">
                                <use xlink:href="#icon-chevron"></use>
                            </svg>
                        </button>
                        <a class="media-item media-item--medium" href="#">
                            <div class="media-item__icon color-red">
                                <div class="media-item__icon-text">#</div><span
                                    class="badge-signal badge-signal--green"></span>

                                <img class="media-item__thumb" id="selected-customer-avatar" alt="#"
                                    src="{% if not customers %}{{ url_for( 'static', filename='img/content/humans/item-3.jpg' ) }}{% else %}https://avatar.oxro.io/avatar.svg?name={{ customers[0].nickname }}{% endif %}">
                            </div>
                            <div class="media-item__right">
                                <h5 class="media-item__title font-weight-medium selected-customer-nickname-h5"
                                    id="selected-customer-nickname"></h5>
                                <h5 style="display:none;"
                                    class="media-item__title font-weight-medium selected-customer-id-h5"
                                    id="selected-customer-id"></h5>
                                <div class="text-sm text-grey">Active 1 min ago</div>
                            </div>
                        </a>
                    </div>
                    <div class="chat-details__top-right">
                        <div class="items-more position-relative">
                            <button class="items-more__button">
                                <svg class="icon-icon-more">
                                    <use xlink:href="#icon-more"></use>
                                </svg>
                            </button>
                            <div class="dropdown-items dropdown-items--right">
                                <div class="dropdown-items__container">
                                    <ul class="dropdown-items__list">
                                        <li class="dropdown-items__item"><a class="dropdown-items__link">Create a
                                                room</a>
                                        </li>
                                        <li class="dropdown-items__item"><a class="dropdown-items__link">Profile</a>
                                        </li>
                                        <li class="dropdown-items__item"><a class="dropdown-items__link">Archived</a>
                                        </li>
                                        <li class="dropdown-items__item"><a class="dropdown-items__link">Settings</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chat-details__content scrollbar-thin scrollbar-hidden" data-simplebar>
                </div>

                <div class="chat-details__bottom">
                    <div class="chat-details__input-group input-group input-group--white">
                        <div class="chat-details__input-prepend">
                            <label class="button-icon button-icon--transparent">
                                <input id="pic-input" type="file" accept=".jpg, .jpeg, .png, .bmp, .gif, .svg"
                                    maxlength="10485760">
                                <!-- TODO: multiple pic upload refactor -->
                                <span class="button-icon__icon">
                                    <svg class="icon-icon-attachment">
                                        <use xlink:href="#icon-attachment"></use>
                                    </svg></span>
                            </label>
                            <div class="chat-details__emoji position-relative">
                                <button class="button-icon button-icon--transparent" data-toggle="dropdown"><span
                                        class="button-icon__icon">
                                        <svg class="icon-icon-emoji">
                                            <use xlink:href="#icon-emoji"></use>
                                        </svg></span>
                                </button>
                                <div class="dropdown-emoji dropdown-menu dropdown-menu--up">
                                    <div class="dropdown-emoji__content">
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/laughing.svg' ) }}"
                                                alt="#" />
                                        </a>
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/happy-2.svg' ) }}"
                                                alt="#" />
                                        </a>
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/crazy.svg' ) }}"
                                                alt="#" />
                                        </a>
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/bad.svg' ) }}"
                                                alt="#" />
                                        </a>
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/angry.svg' ) }}"
                                                alt="#" />
                                        </a>
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/happy.svg' ) }}"
                                                alt="#" />
                                        </a>
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/thinking.svg' ) }}"
                                                alt="#" />
                                        </a>
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/sad.svg' ) }}"
                                                alt="#" />
                                        </a>
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/pressure.svg' ) }}"
                                                alt="#" />
                                        </a>
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/in-love.svg' ) }}"
                                                alt="#" />
                                        </a>
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/nerd.svg' ) }}"
                                                alt="#" />
                                        </a>
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/happy-3.svg' ) }}"
                                                alt="#" />
                                        </a>
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/shocked.svg' ) }}"
                                                alt="#" />
                                        </a>
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/wink.svg' ) }}"
                                                alt="#" />
                                        </a>
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/sweating.svg' ) }}"
                                                alt="#" />
                                        </a>
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/shocked-2.svg' ) }}"
                                                alt="#" />
                                        </a>
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/shocked-3.svg' ) }}"
                                                alt="#" />
                                        </a>
                                        <a class="dropdown-emoji__item" href="#" tabindex="0">
                                            <img class="dropdown-emoji__image"
                                                src="{{ url_for( 'static', filename='img/content/emoji/sad-2.svg' ) }}"
                                                alt="#" />
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <input class="chat-details__input input" id="chat-inputbox" type="text"
                            placeholder="Write a Message...">
                    </div>
                    <div class="chat-details__bottom-right">
                        <button class="button-add button-add--blue" id="send-message"><span class="button-add__icon">
                                <svg class="icon-icon-send">
                                    <use xlink:href="#icon-send"></use>
                                </svg></span><span class="button-add__text"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>
{% endblock %}

<!-- jQuery and JavaScript Bundle with Popper -->
{% block jsLink %}
{{ super() }}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"
    integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA=="
    crossorigin="anonymous"></script>
<script src="{{ url_for('static', filename='js/chatManager.js') }}"></script>
{% endblock %}